generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Employee {
  id                String         @id @default(cuid())
  name              String
  email             String         @unique
  department        String?
  joiningDate       DateTime
  status            String         @default("ACTIVE")
  initialLeaveDays  Int            @default(20)
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  
  leaveRequests     LeaveRequest[] @relation("EmployeeLeaves")
  approvedRequests  LeaveRequest[] @relation("ApproverLeaves")
  
  @@map("employees")
}

model LeaveRequest {
  id              String    @id @default(cuid())
  employeeId      String
  startDate       DateTime
  endDate         DateTime
  daysRequested   Int
  status          String    @default("PENDING")
  reason          String?
  leaveType       String    @default("CASUAL")
  approverId      String?
  approverRemarks String?
  decidedAt       DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  
  employee        Employee  @relation("EmployeeLeaves", fields: [employeeId], references: [id], onDelete: Cascade)
  approver        Employee? @relation("ApproverLeaves", fields: [approverId], references: [id], onDelete: SetNull)
  
  @@index([employeeId])
  @@index([status])
  @@index([startDate, endDate])
  @@map("leave_requests")
}
